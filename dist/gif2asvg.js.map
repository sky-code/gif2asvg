{"version":3,"sources":["gif2asvg.js"],"names":[],"mappings":"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","file":"gif2asvg.js","sourcesContent":["(function (global) {\r\n    'use strict';\r\n\r\n    var omggif;\r\n    var ImageInfo;\r\n    var btoa = global.btoa;\r\n    if (global.__isNode) {\r\n        omggif = require('omggif');\r\n        ImageInfo = require('./image-info');\r\n        btoa = require('btoa');\r\n    } else {\r\n        omggif = { GifWriter: global.GifWriter, GifReader: global.GifReader };\r\n        ImageInfo = global.ImageInfo;\r\n    }\r\n\r\n    class gif2asvg {\r\n        constructor() {\r\n            this.isNode = typeof window === 'undefined';\r\n            this.q = '\"';\r\n        }\r\n\r\n        convertDataURIToBinary(dataUri) {\r\n            const base64Marker = ';base64,';\r\n\r\n            var base64Index = dataUri.indexOf(base64Marker) + base64Marker.length;\r\n            var base64 = dataUri.substring(base64Index);\r\n            var raw = window.atob(base64);\r\n            var rawLength = raw.length;\r\n            var array = new Uint8Array(new ArrayBuffer(rawLength));\r\n\r\n            for (var i = 0; i < rawLength; i++) {\r\n                array[i] = raw.charCodeAt(i);\r\n            }\r\n            return array;\r\n        }\r\n\r\n        convertBinaryToBase64(binaryData) {\r\n            var CHUNK_SIZE = 0x8000; //arbitrary number\r\n            var index = 0;\r\n            var length = binaryData.length;\r\n            var result = '';\r\n            var slice;\r\n            while (index < length) {\r\n                slice = binaryData.subarray(index, Math.min(index + CHUNK_SIZE, length));\r\n                result += String.fromCharCode.apply(null, slice);\r\n                index += CHUNK_SIZE;\r\n            }\r\n            return btoa(result);\r\n        }\r\n\r\n        encodeSvgAsBase64(svg) {\r\n            return `data:image/svg+xml;base64,${btoa(svg)}`;\r\n        }\r\n\r\n        wrapInSvgHeader(svgMarkup, svgWidth, svgHeight) {\r\n            var q = this.q;\r\n            var svgOpen = `<svg xmlns=${q}http://www.w3.org/2000/svg${q} xmlns:A=${q}http://www.w3.org/1999/xlink${q} width=${q}${svgWidth}${q} height=${q}${svgHeight}${q}>`;\r\n            var svgClose = '</svg>';\r\n            return svgOpen + svgMarkup + svgClose;\r\n        }\r\n\r\n        smilSvgAnimationFromBase64Gif(base64ImageData) {\r\n            return this.smilSvgAnimationFromImageDataGif(this.convertDataURIToBinary(base64ImageData));\r\n        }\r\n\r\n        smilSvgAnimationFromImageDataGif(imageData) {\r\n            var gr = new omggif.GifReader(imageData);\r\n            var imageInfo = ImageInfo.fromGifReader(gr);\r\n            return this.smilSvgAnimationFromImageDataFramesGif(imageInfo);\r\n        }\r\n\r\n        _encodeImageDataToPngCanvas(imageData) {\r\n            var canvas = window.document.createElement('canvas');\r\n            canvas.width = imageData.width;\r\n            canvas.height = imageData.height;\r\n            var ctx = canvas.getContext('2d');\r\n            ctx.putImageData(imageData, 0, 0);\r\n            return canvas.toDataURL('image/png');\r\n        }\r\n\r\n        _encodeImageDataToPngNodeJs(imageData) {\r\n            var PNG = require('pngjs').PNG;\r\n\r\n            var png = new PNG();\r\n            png.width = imageData.width;\r\n            png.height = imageData.height;\r\n\r\n            png.data = new Buffer(imageData.data);\r\n            var pngImageData = PNG.sync.write(png);\r\n            var pngDataUri = `data:image/png;base64,${this.convertBinaryToBase64(pngImageData)}`;\r\n            return pngDataUri;\r\n        }\r\n\r\n        encodeImageDataToPng(imageData) {\r\n            if (global.__isNode) {\r\n                return this._encodeImageDataToPngNodeJs(imageData);\r\n            }\r\n            return this._encodeImageDataToPngCanvas(imageData);\r\n        }\r\n\r\n        generateImageId (imageData, imageIndex) {\r\n            return `F${imageIndex}`;\r\n        }\r\n\r\n        generateAnimationId(imageData, imageIndex) {\r\n            return `A${imageIndex}`;\r\n        }\r\n\r\n        smilSvgAnimationFromImageDataFramesGif(imageData) {\r\n            var q = this.q;\r\n            var svg = '';\r\n            var setTags = '';\r\n            for (var i = 0; i < imageData.frames.length; i++) {\r\n                var frame = imageData.frames[i];\r\n\r\n                var pngImageDataUri = this.encodeImageDataToPng(frame);\r\n\r\n                var imageId = this.generateImageId(imageData, i);\r\n                var imgTag = `<image id=${q}${imageId}${q} height=${q}100%${q} width=${q}0${q} A:href=${q}${pngImageDataUri}${q}/>`;\r\n\r\n                var setTagId = this.generateAnimationId(imageData, i);\r\n                var begin = '';\r\n                if (i === 0) {\r\n                    begin += `${this.generateAnimationId(imageData, imageData.frames.length - 1)}.end; 0s`;\r\n                } else {\r\n                    begin += `${this.generateAnimationId(imageData, i - 1)}.end;`;\r\n                }\r\n\r\n                var setTag = `<set id=${q}${setTagId}${q} A:href=${q}#${imageId}${q} attributeName=${q}width${q} to=${q}100%${q} dur=${q}${frame.delay}ms${q} begin=${q}${begin}${q}/>`;\r\n                setTags += setTag;\r\n                svg += imgTag;\r\n            }\r\n\r\n            svg += setTags;\r\n\r\n            svg = this.wrapInSvgHeader(svg, imageData.width, imageData.height);\r\n            return svg;\r\n        }\r\n    }\r\n\r\n// ReSharper disable once JsUnreachableCode\r\n    if (global.__isNode) {\r\n        module.exports = gif2asvg;\r\n\r\n    } else {\r\n        global.gif2asvg = gif2asvg;\r\n    }\r\n\r\n})(typeof window === 'undefined' ? global : window);"],"sourceRoot":"/source/"}