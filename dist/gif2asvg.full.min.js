"use strict";function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}!function(e){var a={};a.isNode="undefined"==typeof window,a.isNode?module.exports=a:e.ImageInfo=a,a.createImageData=function(e,t){if(a.isNode){var n=Uint8ClampedArray||Uint8Array,r={width:e,height:t};return r.data=new n(e*t*4),r}var i=window.document.createElement("canvas").getContext("2d");return i.createImageData(e,t)},a.fromGifReader=function(e){var t=a.createImageData(e.width,e.height);t.frames=[];for(var n=0;n<e.numFrames();n++){var r=e.frameInfo(n),i=r.width,o=r.height,d=a.createImageData(i,o);d.data_length=r.data_length,d.data_offset=r.data_offset,d.delay=r.delay,d.disposal=r.disposal,d.has_local_palette=r.has_local_palette,d.interlaced=r.interlaced,d.palette_offset=r.palette_offset,d.transparent_index=r.transparent_index,d.x=r.x,d.y=r.y,e.decodeAndBlitFrameRGBA(n,d.data),t.frames[n]=d,d.delay&&(d.delay=10*d.delay)}return t.loopCount=e.loopCount(),t.loopCount||(t.loopCount=-1),t}}("undefined"==typeof window?global:window);var _createClass=function(){function e(e,a){for(var t=0;t<a.length;t++){var n=a[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(a,t,n){return t&&e(a.prototype,t),n&&e(a,n),a}}();!function(e){if(e.isNode="undefined"==typeof window,e.isNode)var a=require("omggif"),t=require("./image-info");else var a={GifWriter:e.GifWriter,GifReader:e.GifReader},t=e.ImageInfo;e.isNode&&"undefined"==typeof btoa&&(e.btoa=function(e){var a;return a=e instanceof Buffer?e:new Buffer(e.toString(),"binary"),a.toString("base64")});var n='"',r=function(){function r(){_classCallCheck(this,r),this.isNode="undefined"==typeof window}return _createClass(r,[{key:"convertDataURIToBinary",value:function(e){for(var a=";base64,",t=e.indexOf(a)+a.length,n=e.substring(t),r=window.atob(n),i=r.length,o=new Uint8Array(new ArrayBuffer(i)),d=0;i>d;d++)o[d]=r.charCodeAt(d);return o}},{key:"convertBinaryToBase64",value:function(e){for(var a,t=32768,n=0,r=e.length,i="";r>n;)a=e.subarray(n,Math.min(n+t,r)),i+=String.fromCharCode.apply(null,a),n+=t;return btoa(i)}},{key:"encodeSvgAsBase64",value:function(e){return"data:image/svg+xml;base64,"+btoa(e)}},{key:"wrapInSvgHeader",value:function(e,a,t){var r='<svg id="ts0000000000000000" xmlns='+n+"http://www.w3.org/2000/svg"+n+" xmlns:A="+n+"http://www.w3.org/1999/xlink"+n+" width="+n+a+n+" height="+n+t+n+">",i="</svg>";return r+e+i}},{key:"smilSvgAnimationFromBase64Gif",value:function(e){return this.smilSvgAnimationFromImageDataGif(this.convertDataURIToBinary(e))}},{key:"smilSvgAnimationFromImageDataGif",value:function(e){var n=new a.GifReader(e),r=t.fromGifReader(n);return this.smilSvgAnimationFromImageDataFramesGif(r)}},{key:"encodeImageDataToPngCanvas",value:function(e){var a=window.document.createElement("canvas");a.width=e.width,a.height=e.height;var t=a.getContext("2d");return t.putImageData(e,0,0),a.toDataURL("image/png")}},{key:"_encodeImageDataToPngNodeJs",value:function(e){var a=require("pngjs").PNG,t=new a;t.width=e.width,t.height=e.height,t.data=new Buffer(e.data);var n=a.sync.write(t),r="data:image/png;base64,"+this.convertBinaryToBase64(n);return r}},{key:"encodeImageDataToPng",value:function(a){return e.isNode?this._encodeImageDataToPngNodeJs(a):this._encodeImageDataToPngCanvas(a)}},{key:"generateImageId",value:function(e,a){return"F"+a}},{key:"generateAnimationId",value:function(e,a){return"A"+a}},{key:"smilSvgAnimationFromImageDataFramesGif",value:function(e){for(var a="",t="",r=0;r<e.frames.length;r++){var i=e.frames[r],o=this.encodeImageDataToPng(i),d=this.generateImageId(e,r),s="<image id="+n+d+n+" height="+n+"100%"+n+" width="+n+"0"+n+" A:href="+n+o+n+"/>",f=this.generateAnimationId(e,r),u="";u+=0===r?this.generateAnimationId(e,e.frames.length-1)+".end; 0s":this.generateAnimationId(e,r-1)+".end;";var g="<set id="+n+f+n+" A:href="+n+"#"+d+n+" attributeName="+n+"width"+n+" to="+n+"100%"+n+" dur="+n+i.delay+"ms"+n+" begin="+n+u+n+"/>";t+=g,a+=s}return a+=t,a=this.wrapInSvgHeader(a,e.width,e.height)}}]),r}();e.isNode?module.exports=r:e.gif2asvg=r}("undefined"==typeof window?global:window);
//# sourceMappingURL=gif2asvg.full.min.js.map
